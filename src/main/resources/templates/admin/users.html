<!DOCTYPE html>
<html lang="bg" xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ –ü–æ—Ç—Ä–µ–±–∏—Ç–µ–ª–∏ - UFC –ë—ä–ª–≥–∞—Ä–∏—è</title>
    <link rel="stylesheet" th:href="@{/css/styles.css}">
</head>
<body>
    <header>
        <div class="container">
            <div class="header-content">
                <a th:href="@{/}" class="logo">
                    <div class="logo-icon">UFC</div>
                    <h1>UFC –ë—ä–ª–≥–∞—Ä–∏—è - –ê–¥–º–∏–Ω</h1>
                </a>
                <div class="auth-buttons">
                    <div sec:authorize="isAuthenticated()" class="user-info">
                        <span class="user-welcome">–ó–¥—Ä–∞–≤–µ–π, <strong sec:authentication="name">Admin</strong>!</span>
                        <form th:action="@{/logout}" method="post" style="display: inline;">
                            <button type="submit" class="btn btn-danger">–ò–∑—Ö–æ–¥</button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <nav>
        <div class="container">
            <div class="nav-content">
                <ul class="nav-links">
                    <li><a th:href="@{/}">–ù–∞—á–∞–ª–æ</a></li>
                    <li><a th:href="@{/admin/dashboard}">–¢–∞–±–ª–æ</a></li>
                    <li><a th:href="@{/admin/users}" class="active">–ü–æ—Ç—Ä–µ–±–∏—Ç–µ–ª–∏</a></li>
                    <li><a th:href="@{/admin/topics}">–¢–µ–º–∏</a></li>
                    <li><a th:href="@{/admin/comments}">–ö–æ–º–µ–Ω—Ç–∞—Ä–∏</a></li>
                    <li><a th:href="@{/admin/analytics}">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏</a></li>
                </ul>
            </div>
        </div>
    </nav>

    <main class="container">
        <!-- Success/Error Messages -->
        <div th:if="${successMessage}" class="alert alert-success" role="alert">
            ‚úÖ <span th:text="${successMessage}">Success!</span>
        </div>
        <div th:if="${errorMessage}" class="alert alert-danger" role="alert">
            ‚ùå <span th:text="${errorMessage}">Error!</span>
        </div>

        <div class="admin-page">
            <h2>üë• –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ –ü–æ—Ç—Ä–µ–±–∏—Ç–µ–ª–∏</h2>

            <!-- Search and Filters -->
            <div class="admin-filters">
                <form th:action="@{/admin/users}" method="get" class="admin-search-form">
                    <input type="text" name="search" th:value="${search}" placeholder="–¢—ä—Ä—Å–µ–Ω–µ –ø–æ –∏–º–µ –∏–ª–∏ –∏–º–µ–π–ª..." class="admin-search-input">
                    <button type="submit" class="btn btn-primary">üîç –¢—ä—Ä—Å–∏</button>
                </form>

                <div class="admin-filter-buttons">
                    <a th:href="@{/admin/users}" class="filter-btn" th:classappend="${role == null && status == null} ? 'active' : ''">–í—Å–∏—á–∫–∏</a>
                    <a th:href="@{/admin/users(role='ADMIN')}" class="filter-btn" th:classappend="${role == 'ADMIN'} ? 'active' : ''">–ê–¥–º–∏–Ω–∏</a>
                    <a th:href="@{/admin/users(role='USER')}" class="filter-btn" th:classappend="${role == 'USER'} ? 'active' : ''">–ü–æ—Ç—Ä–µ–±–∏—Ç–µ–ª–∏</a>
                    <a th:href="@{/admin/users(status='banned')}" class="filter-btn" th:classappend="${status == 'banned'} ? 'active' : ''">–ë–ª–æ–∫–∏—Ä–∞–Ω–∏</a>
                </div>
            </div>

            <!-- Users Table -->
            <div class="admin-table-container">
                <table class="admin-table">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>–ü–æ—Ç—Ä–µ–±–∏—Ç–µ–ª</th>
                            <th>–ò–º–µ–π–ª</th>
                            <th>–†–æ–ª—è</th>
                            <th>–°—Ç–∞—Ç—É—Å</th>
                            <th>–†–µ–≥–∏—Å—Ç—Ä–∏—Ä–∞–Ω</th>
                            <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr th:if="${users.isEmpty()}">
                            <td colspan="7" class="empty-state">–ù—è–º–∞ –Ω–∞–º–µ—Ä–µ–Ω–∏ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª–∏</td>
                        </tr>
                        <tr th:each="user : ${users}">
                            <td th:text="${user.id}">1</td>
                            <td>
                                <a th:href="@{/user/profile/{username}(username=${user.username})}" th:text="${user.username}">Username</a>
                            </td>
                            <td th:text="${user.email}">email@example.com</td>
                            <td>
                                <span class="badge" th:classappend="${user.role.name() == 'ADMIN'} ? 'badge-admin' : 'badge-user'" th:text="${user.role}">USER</span>
                            </td>
                            <td>
                                <span class="badge" th:classappend="${user.enabled} ? 'badge-active' : 'badge-banned'" th:text="${user.enabled ? '–ê–∫—Ç–∏–≤–µ–Ω' : '–ë–ª–æ–∫–∏—Ä–∞–Ω'}">Active</span>
                            </td>
                            <td th:text="${#temporals.format(user.createdAt, 'dd.MM.yyyy')}">01.01.2024</td>
                            <td class="admin-actions">
                                <a th:href="@{/admin/users/{id}/edit(id=${user.id})}" class="btn-admin-small btn-edit">‚úèÔ∏è –†–µ–¥–∞–∫—Ü–∏—è</a>

                                <form th:if="${user.enabled}" th:action="@{/admin/users/{id}/ban(id=${user.id})}" method="post" style="display: inline;"
                                      onsubmit="return confirm('–°–∏–≥—É—Ä–Ω–∏ –ª–∏ —Å—Ç–µ, —á–µ –∏—Å–∫–∞—Ç–µ –¥–∞ –±–ª–æ–∫–∏—Ä–∞—Ç–µ —Ç–æ–∑–∏ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª?')">
                                    <button type="submit" class="btn-admin-small btn-ban">üö´ –ë–ª–æ–∫–∏—Ä–∞–π</button>
                                </form>

                                <form th:if="${!user.enabled}" th:action="@{/admin/users/{id}/unban(id=${user.id})}" method="post" style="display: inline;">
                                    <button type="submit" class="btn-admin-small btn-unban">‚úÖ –û—Ç–±–ª–æ–∫–∏—Ä–∞–π</button>
                                </form>

                                <form th:action="@{/admin/users/{id}/delete(id=${user.id})}" method="post" style="display: inline;"
                                      onsubmit="return confirm('–í–ù–ò–ú–ê–ù–ò–ï! –¢–æ–≤–∞ –¥–µ–π—Å—Ç–≤–∏–µ –µ –Ω–µ–æ–±—Ä–∞—Ç–∏–º–æ! –°–∏–≥—É—Ä–Ω–∏ –ª–∏ —Å—Ç–µ, —á–µ –∏—Å–∫–∞—Ç–µ –¥–∞ –∏–∑—Ç—Ä–∏–µ—Ç–µ —Ç–æ–∑–∏ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª?')">
                                    <button type="submit" class="btn-admin-small btn-delete">üóëÔ∏è –ò–∑—Ç—Ä–∏–π</button>
                                </form>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div class="admin-summary">
                <p>–û–±—â–æ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª–∏: <strong th:text="${users.size()}">0</strong></p>
            </div>
        </div>
    </main>

    <footer>
        <div class="container">
            <div class="footer-bottom">
                <p>&copy; 2024 UFC –ë—ä–ª–≥–∞—Ä–∏—è –§–æ—Ä—É–º - –ê–¥–º–∏–Ω –ü–∞–Ω–µ–ª</p>
            </div>
        </div>
    </footer>
</body>
</html>

