<!DOCTYPE html>
<html lang="bg" xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title th:text="${profile.username} + ' - –ü—Ä–æ—Ñ–∏–ª - UFC –ë—ä–ª–≥–∞—Ä–∏—è'">–ü—Ä–æ—Ñ–∏–ª - UFC –ë—ä–ª–≥–∞—Ä–∏—è</title>
    <link rel="stylesheet" th:href="@{/css/styles.css}">
</head>
<body>
    <header>
        <div class="container">
            <div class="header-content">
                <a th:href="@{/}" class="logo">
                    <div class="logo-icon">UFC</div>
                    <h1>UFC –ë—ä–ª–≥–∞—Ä–∏—è</h1>
                </a>
                <div class="auth-buttons">
                    <div sec:authorize="!isAuthenticated()">
                        <a th:href="@{/login}" class="btn btn-secondary">–í—Ö–æ–¥</a>
                        <a th:href="@{/user/register}" class="btn btn-primary">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</a>
                    </div>
                    <div sec:authorize="isAuthenticated()" class="user-info">
                        <span class="user-welcome">–ó–¥—Ä–∞–≤–µ–π, <strong sec:authentication="name">User</strong>!</span>
                        <form th:action="@{/logout}" method="post" style="display: inline;">
                            <button type="submit" class="btn btn-danger">–ò–∑—Ö–æ–¥</button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <nav>
        <div class="container">
            <div class="nav-content">
                <ul class="nav-links">
                    <li><a th:href="@{/}">–ù–∞—á–∞–ª–æ</a></li>
                    <li><a th:href="@{/forum}">–§–æ—Ä—É–º</a></li>
                    <li><a href="#" title="–ù–æ–≤–∏–Ω–∏ (–°–∫–æ—Ä–æ)">–ù–æ–≤–∏–Ω–∏</a></li>
                    <li><a href="#" title="–ë–æ–µ–≤–µ (–°–∫–æ—Ä–æ)">–ë–æ–µ–≤–µ</a></li>
                    <li><a href="#" title="–ê–Ω–∞–ª–∏–∑–∏ (–°–∫–æ—Ä–æ)">–ê–Ω–∞–ª–∏–∑–∏</a></li>
                    <li><a href="#" title="–ß–ª–µ–Ω–æ–≤–µ (–°–∫–æ—Ä–æ)">–ß–ª–µ–Ω–æ–≤–µ</a></li>
                </ul>
            </div>
        </div>
    </nav>

    <main class="container">
        <div th:if="${successMessage}" class="alert alert-success" role="alert">
            ‚úÖ <span th:text="${successMessage}">Success!</span>
        </div>

        <div class="profile-container">
            <!-- Profile Header -->
            <div class="profile-header">
                <div class="profile-avatar-section">
                    <div class="profile-avatar-large">
                        <span th:text="${#strings.substring(profile.username, 0, 1).toUpperCase()}">U</span>
                    </div>
                    <div class="profile-info">
                        <h2 th:text="${profile.username}">Username</h2>
                        <div class="profile-role" th:text="${profile.role}">USER</div>
                        <div class="profile-joined">
                            –ß–ª–µ–Ω –æ—Ç: <span th:text="${#temporals.format(profile.createdAt, 'dd.MM.yyyy')}">Date</span>
                        </div>
                    </div>
                </div>

                <div class="profile-actions" th:if="${isOwnProfile}">
                    <a th:href="@{/user/profile/edit}" class="btn btn-secondary">‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–∞–π –ø—Ä–æ—Ñ–∏–ª</a>
                </div>
            </div>

            <!-- Profile Stats -->
            <div class="profile-stats">
                <div class="stat-box">
                    <div class="stat-number" th:text="${profile.topicCount}">0</div>
                    <div class="stat-label">–¢–µ–º–∏</div>
                </div>
                <div class="stat-box">
                    <div class="stat-number" th:text="${profile.postCount}">0</div>
                    <div class="stat-label">–ö–æ–º–µ–Ω—Ç–∞—Ä–∏</div>
                </div>
                <div class="stat-box">
                    <div class="stat-number" th:text="${profile.reputation}">0</div>
                    <div class="stat-label">–†–µ–ø—É—Ç–∞—Ü–∏—è</div>
                </div>
            </div>

            <!-- Bio Section -->
            <div class="profile-bio" th:if="${profile.bio != null and !#strings.isEmpty(profile.bio)}">
                <h3>–ó–∞ –º–µ–Ω</h3>
                <p th:text="${profile.bio}">User bio</p>
            </div>

            <!-- Activity Tabs -->
            <div class="profile-tabs">
                <div class="tab-buttons">
                    <a th:href="@{/user/profile/{username}(username=${profile.username}, tab='topics')}"
                       th:class="${activeTab == 'topics' ? 'tab-btn active' : 'tab-btn'}">
                        üìù –¢–µ–º–∏
                    </a>
                    <a th:href="@{/user/profile/{username}(username=${profile.username}, tab='posts')}"
                       th:class="${activeTab == 'posts' ? 'tab-btn active' : 'tab-btn'}">
                        üí¨ –ö–æ–º–µ–Ω—Ç–∞—Ä–∏
                    </a>
                </div>

                <!-- Topics Tab -->
                <div class="tab-content" th:if="${activeTab == 'topics'}">
                    <h3>–ü–æ—Å–ª–µ–¥–Ω–∏ —Ç–µ–º–∏</h3>
                    <div th:if="${topics != null and !topics.isEmpty()}" class="profile-topics-list">
                        <div th:each="topic : ${topics}" class="profile-topic-item">
                            <div class="topic-info">
                                <h4 class="topic-title">
                                    <a th:href="@{/forum/topic/{id}(id=${topic.id})}" th:text="${topic.title}">Topic Title</a>
                                </h4>
                                <div class="topic-meta">
                                    <span class="topic-category" th:text="${topic.category.displayName}">Category</span>
                                    <span class="topic-date" th:text="${#temporals.format(topic.createdAt, 'dd.MM.yyyy HH:mm')}">Date</span>
                                </div>
                            </div>
                            <div class="topic-stats-small">
                                <span>üëÅÔ∏è <strong th:text="${topic.viewCount}">0</strong></span>
                                <span>üí¨ <strong th:text="${topic.replyCount}">0</strong></span>
                            </div>
                        </div>
                    </div>
                    <div th:if="${topics == null or topics.isEmpty()}" class="no-content">
                        <p>–í—Å–µ –æ—â–µ –Ω—è–º–∞ —Å—ä–∑–¥–∞–¥–µ–Ω–∏ —Ç–µ–º–∏.</p>
                    </div>
                </div>

                <!-- Posts Tab -->
                <div class="tab-content" th:if="${activeTab == 'posts'}">
                    <h3>–ü–æ—Å–ª–µ–¥–Ω–∏ –∫–æ–º–µ–Ω—Ç–∞—Ä–∏</h3>
                    <div th:if="${posts != null and !posts.isEmpty()}" class="profile-posts-list">
                        <div th:each="post : ${posts}" class="profile-post-item">
                            <div class="post-preview">
                                <p th:text="${#strings.abbreviate(post.content, 150)}">Post content preview...</p>
                            </div>
                            <div class="post-info">
                                <span>–í —Ç–µ–º–∞: <a th:href="@{/forum/topic/{id}(id=${post.topic.id})}" th:text="${post.topic.title}">Topic</a></span>
                                <span class="post-date" th:text="${#temporals.format(post.createdAt, 'dd.MM.yyyy HH:mm')}">Date</span>
                            </div>
                        </div>
                    </div>
                    <div th:if="${posts == null or posts.isEmpty()}" class="no-content">
                        <p>–í—Å–µ –æ—â–µ –Ω—è–º–∞ –Ω–∞–ø–∏—Å–∞–Ω–∏ –∫–æ–º–µ–Ω—Ç–∞—Ä–∏.</p>
                    </div>
                </div>
            </div>
        </div>

        <div class="back-action">
            <a th:href="@{/forum}" class="btn btn-secondary">‚Üê –ù–∞–∑–∞–¥ –∫—ä–º —Ñ–æ—Ä—É–º–∞</a>
        </div>
    </main>

    <footer>
        <div class="container">
            <p>&copy; 2025 UFC –ë—ä–ª–≥–∞—Ä–∏—è. –í—Å–∏—á–∫–∏ –ø—Ä–∞–≤–∞ –∑–∞–ø–∞–∑–µ–Ω–∏.</p>
        </div>
    </footer>
</body>
</html>

